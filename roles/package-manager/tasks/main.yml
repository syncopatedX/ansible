---
# Simple package manager - just install packages

- name: Load distribution-specific variables
  include_vars: "{{ ansible_os_family }}.yml"
  tags: ["packages"]

- name: Install packages (Arch Linux)
  pacman:
    name: "{{ packages | map(attribute='name') | list }}"
    state: present
  become: true
  when: 
    - ansible_os_family == "Archlinux"
    - packages is defined
  tags: ["packages"]

- name: Install packages (Rocky Linux)
  dnf:
    name: "{{ package_mappings.get(item, item) }}"
    state: present
  loop: "{{ packages | map(attribute='name') | list }}"
  become: true
  when: 
    - ansible_os_family == "RedHat"
    - packages is defined
    - not package_mappings.get(item, item).startswith('#')
  tags: ["packages"]

